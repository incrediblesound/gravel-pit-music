{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/instruments/Listener.js","webpack:///./src/ui/ValueInput.js","webpack:///./src/ui/InstrumentControlValue.js","webpack:///./src/instruments/kick.js","webpack:///./src/ui/Options.js","webpack:///./src/ui/InstrumentControlOptions.js","webpack:///./src/instruments/leadSynth.js","webpack:///./src/instruments/synth.js","webpack:///./src/instruments/fm.js","webpack:///./src/instruments/snare.js","webpack:///./src/instruments/hat.js","webpack:///./src/constants.js","webpack:///./src/state.js","webpack:///./src/ui/Word.js","webpack:///./src/ui/Button.js","webpack:///./src/ui/switch.js","webpack:///./src/ui/Blinker.js","webpack:///./src/ui/note.js","webpack:///./src/instruments/instrumentControlFunctions.js","webpack:///./src/main.js","webpack:///./src/ui/PlayBtn.js","webpack:///./src/ui/PageButton.js","webpack:///./src/ui/SequenceList.js","webpack:///./src/ui/Tempo.js","webpack:///./src/ui/InstrumentWindow.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Listener","setProp","action","Array","isArray","this","ValueInput","constructor","ctx","x","y","initialValue","maxValue","cb","context","callback","render","fillStyle","fillRect","clearRect","fillText","handleClick","innerX","innerY","section","Math","floor","abs","ControlValue","text","valueInput","KickSynth","super","volume","decay","attack","config","type","stopAll","getOscillators","note","osc","createOscillator","blipOsc","gain","createGain","blipGain","frequency","detune","connect","destination","play","step","start","setTargetAtTime","currentTime","stop","Options","options","currentValue","idx","undefined","indexOf","callBack","offset","ceil","measureText","width","length","ControlOptions","LeadSynth","previousTone","previousOct","filterValue","initialFrequency","prevOsc","playing","filterType","Q","octave","waveform","prevGainNode","forEach","g","oct","gainNode","filter","createBiquadFilter","hold","osc1","gainNode1","filter1","osc2","gainNode2","filter2","KeySynth","oscillators","osc3","makeOscillator","filters","fmModeMethods","parallel","vertical","fmSynth","mod1Oct","mod2Oct","waveformOptions","fmMode","storeOscillators","data","keys","modulator1","modulator2","modulatorA","modulatorB","getModulator","wave","modulator","modulatorGain","getOscillator","pan","panNode","createStereoPanner","panValue","setupOscillators_A","modulatorGainA","modulatorGainB","modulatorGain1","modulatorGain2","setupOscillators_B","methodName","Snare","buffer","bufferSize","sampleRate","createBuffer","output","getChannelData","random","noiseBuffer","setVolume","getNoise","noise","createBufferSource","noiseFilter","noiseEnvelope","Hat","time","COLOR","LOOP_LENGTH","SEQUENCE_LENGTH","makeStepArray","steps","empty","fill","map","item","Word","word","Button","textWidth","toggled","isToggled","wordMargin","OctaveSwitch","state","colors","page","getPage","isHold","Blinker","blinkers","on","drawCircle","beginPath","arc","PI","lineWidth","strokeStyle","stroke","toggle","Note","parent","notes","noteIndex","bass","moduleMap","initialVolume","instruments","push","initialFilter","lead","waveform1","waveform2","octave1","octave2","initialFrequencyValue","initialQ","controlQ","fm","initialDecay","initialMod1Oct","initialMod2Oct","kick","initialAttack","hat","snare","canvas","document","getElementById","getContext","font","audioCtx","swingIsOn","isPlaying","tempo","viewPage","playPage","sequenceIndex","sequence","blocks","children","copyBuffer","BassSynth","child","trigger","message","instrument","drawScreen","copyPage","pastePage","setSequence","toggleStep","values","togglePlay","resume","then","noteTime","startTime","rhythmIndex","previousRhythmIndex","schedule","stepKey","slice","assign","nextTime","advanceNote","interval","setTimeout","secondsPerBeat","window","clearInterval","suspend","AudioContext","webkitAudioContext","playBtn","pageButton","pageOne","buttonIdx","sequenceControl","tempoText","swingToggle","main_ctx","instrumentWindow","instrumentControlMap","instrumentControls","build","buildInstrumentControls","instrumentControlFunctions","setInstrument","renderChildren","k","startX","btn","onclick","e","totalOffsetX","totalOffsetY","canvasX","canvasY","currentElement","offsetLeft","scrollLeft","offsetTop","scrollTop","offsetParent","pageX","scrollX","pageY","scrollY","pageKeys","onkeydown","code","parseInt","split","instrumentIdx"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export default class Listener {\n  setProp(action){\n    if(Array.isArray(action.property)){\n      // flimsy, just for setting array indexes of properties\n      this[action.property[0]][action.property[1]] = action.value\n    } else {\n      this[action.property] = action.value\n    }\n  }\n}\n","export default class ValueInput {\n  constructor({ ctx, x, y, initialValue, maxValue, cb }){\n    this.context = ctx\n    this.value = initialValue\n    this.maxValue = maxValue\n    this.x = x\n    this.y = y\n    this.callback = cb\n  }\n  render(){\n    this.context.fillStyle = 'black'\n    this.context.fillRect(this.x, this.y, 40, 40)\n    this.context.clearRect(this.x+1, this.y+1, 38, 38)\n    this.context.fillText('+', this.x+20, this.y+13, 40)\n    this.context.fillText('-', this.x+21, this.y+37, 40)\n    this.context.fillText(this.value, this.x+5, this.y+25, 40)\n  }\n  handleClick(x, y, innerX, innerY){\n    const section = Math.floor(innerY/20)\n    this.value = Math.abs((section ? this.value-1 : this.value+1) % this.maxValue)\n    this.callback(this.value)\n    this.render()\n  }\n}\n","import ValueInput from './ValueInput'\n\nexport default class ControlValue {\n  constructor(ctx, x, y, text, initialValue, maxValue, cb){\n    this.context = ctx\n    this.x = x\n    this.y = y\n    this.text = text\n    this.valueInput = new ValueInput({\n      ctx, x: x+80, y, initialValue, maxValue, cb\n    })\n  }\n  handleClick(x, y, innerX, innerY){\n    this.valueInput.handleClick(x, y, innerX, innerY)\n  }\n  render(){\n    this.context.fillStyle = 'black'\n    this.context.fillRect(this.x, this.y, 120, 40)\n    this.context.clearRect(this.x+1, this.y+1, 118, 38)\n    this.context.fillText(this.text, this.x+5, this.y+25, 80);\n    this.valueInput.render()\n  }\n}\n","import Listener from './Listener'\nimport ControlValue from '../ui/InstrumentControlValue'\n\nexport default class KickSynth extends Listener {\n  constructor(ctx){\n    super()\n    this.volume = 8\n    this.context = ctx\n    this.decay = 0\n    this.attack = 9\n    this.config = {\n      type: 'sine'\n    }\n  }\n  stopAll(){}\n  getOscillators(note){\n    const osc = this.context.createOscillator()\n    const blipOsc = this.context.createOscillator()\n    const gain = this.context.createGain()\n    const blipGain = this.context.createGain()\n    gain.gain.value = this.volume * 0.1\n    blipGain.gain.value = (this.volume - (9 - this.attack)) * 0.1\n    osc.frequency.value = 55\n    blipOsc.frequency.value = 440\n    osc.detune.value = note * 100\n    blipOsc.detune.value = note * 100\n    osc.connect(gain)\n    blipOsc.connect(blipGain)\n    gain.connect(this.context.destination)\n    blipGain.connect(this.context.destination)\n    return [ osc, gain, blipOsc, blipGain ]\n  }\n  play({ step, note }){\n    const [ osc, gain, blipOsc, blipGain ] = this.getOscillators(note)\n    if(step){\n      osc.start()\n      blipOsc.start()\n      blipGain.gain.setTargetAtTime(this.volume * 0.1, this.context.currentTime, 0.01*this.attack);\n      gain.gain.setTargetAtTime(0, this.context.currentTime, 0.07 + (this.decay * 0.01));\n      blipGain.gain.setTargetAtTime(0, this.context.currentTime, 0.10);\n      blipOsc.frequency.setTargetAtTime(55, this.context.currentTime, 0.05)\n      osc.stop(this.context.currentTime+1)\n      blipOsc.stop(this.context.currentTime+1)\n    }\n  }\n}\n\nexport const kickControlFunction = (state, modules, moduleMap, ctx, x, y) => {\n  const initialVolume = state.instruments.kick.volume\n  const volume = new ControlValue(ctx, x, y, 'Volume', initialVolume, 10, (value) => {\n      state.instruments.kick.setProp({ property: 'volume', value })\n  })\n  modules.push(volume)\n  moduleMap['0/0'] = volume\n  moduleMap['1/0'] = volume\n  moduleMap['2/0'] = volume\n\n  const initialAttack = state.instruments.kick.attack\n  const attack = new ControlValue(ctx, x, y+40, 'Attack', initialAttack, 10, (value) => {\n      state.instruments.kick.setProp({ property: 'attack', value })\n  })\n  modules.push(attack)\n  moduleMap['0/1'] = attack\n  moduleMap['1/1'] = attack\n  moduleMap['2/1'] = attack\n}\n","export default class Options {\n  constructor({ options, currentValue, cb, ctx, x, y }){\n    this.context = ctx\n    this.idx = currentValue !== undefined ? options.indexOf(currentValue) : 0\n    this.options = options\n    this.callBack = cb\n    this.x = x\n    this.y = y\n  }\n  render(){\n    this.context.fillStyle = 'black'\n    this.context.fillRect(this.x, this.y, 80, 40)\n    this.context.clearRect(this.x+1, this.y+1, 78, 38)\n    const text = this.options[this.idx]\n    const textWidth = Math.ceil(this.context.measureText(text).width)\n    const offset = 40 - textWidth/2\n    this.context.fillText(text, this.x+offset, this.y+25, 39);\n  }\n  handleClick(){\n    this.idx = (this.idx+1) % this.options.length\n    this.render()\n    this.callBack(this.options[this.idx])\n  }\n}\n","import Options from './Options'\n\nexport default class ControlOptions {\n  constructor(ctx, x, y, text, options, currentValue, cb){\n    this.context = ctx\n    this.x = x\n    this.y = y\n    this.text = text\n    this.valueInput = new Options({\n      options, currentValue, cb, ctx, x: x+80, y\n    })\n  }\n  handleClick(x, y, innerX, innerY){\n    this.valueInput.handleClick(x, y, innerX, innerY)\n  }\n  render(){\n    this.context.fillStyle = 'black'\n    this.context.fillRect(this.x, this.y, 120, 40)\n    this.context.clearRect(this.x+1, this.y+1, 118, 38)\n    this.context.fillText(this.text, this.x+5, this.y+25, 80);\n    this.valueInput.render()\n  }\n}\n","import Listener from './Listener'\nimport ControlValue from '../ui/InstrumentControlValue'\nimport ControlOptions from '../ui/InstrumentControlOptions'\n\nexport default class LeadSynth extends Listener {\n  constructor(ctx){\n    super()\n    this.volume = 8\n    this.context = ctx\n    this.previousTone = 0\n    this.previousOct = 1\n    this.decay = 0\n    this.filterValue = 0\n    this.initialFrequency = 0\n    this.prevOsc = null\n    this.playing = false\n    this.filterType = 'lowpass'\n    this.Q = 0\n    this.octave = [1, 1]\n    this.waveform = ['sine', 'sine']\n  }\n  stopAll(){\n    if(!this.prevOsc) return\n    this.prevGainNode.forEach(g => g.gain.setTargetAtTime(0, this.context.currentTime+0.01+(this.decay*0.02), 0.05));\n    this.prevOsc.forEach(osc => osc.stop(this.context.currentTime+1))\n    this.prevOsc = null\n    this.playing = false\n  }\n  getOscillators(note, oct, idx){\n    this.previousTone = note\n    this.previousOct = oct\n\n    const osc = this.context.createOscillator()\n    osc.detune.value = this.previousTone * 100\n    osc.frequency.value = this.previousOct * (440 * this.octave[idx])\n    osc.type = this.waveform[idx]\n\n    const gainNode = this.context.createGain()\n    gainNode.gain.value = this.volume*0.1\n\n    const filter = this.context.createBiquadFilter();\n    filter.type = this.filterType\n    filter.Q.value = this.Q * 5\n    filter.frequency.value = this.initialFrequency ? this.initialFrequency * 1000 : 500\n\n    osc.connect(filter)\n    filter.connect(gainNode)\n    gainNode.connect(this.context.destination)\n\n    return [ osc, gainNode, filter ]\n  }\n  play({ step, note, hold }){\n    if(step && !hold){\n      this.stopAll()\n      const [ osc1, gainNode1, filter1 ] = this.getOscillators(note, step, 0)\n      const [ osc2, gainNode2, filter2 ] = this.getOscillators(note, step, 1)\n      this.prevOsc = [ osc1, osc2 ]\n      this.prevGainNode = [ gainNode1, gainNode2 ]\n      osc1.start()\n      osc2.start()\n      filter1.frequency.setTargetAtTime(this.filterValue*1000, this.context.currentTime, 0.1)\n      filter2.frequency.setTargetAtTime(this.filterValue*1000, this.context.currentTime, 0.1)\n      this.playing = true\n    }\n    if((step && this.playing) || (hold && step && this.playing)){\n      this.prevOsc.forEach(osc => osc.detune.setTargetAtTime(note*100, this.context.currentTime, 0.03))\n      this.prevOsc.forEach(osc => osc.frequency.setTargetAtTime(step*440, this.context.currentTime, 0.03))\n    }\n    if(!step && this.prevOsc){\n      this.stopAll()\n    }\n\n  }\n}\n\nexport const leadControlFunction = (state, modules, moduleMap, ctx, x, y) => {\n  const initialVolume = state.instruments.lead.volume\n  const volume = new ControlValue(ctx, x, y, 'Volume', initialVolume, 10, (value) => {\n      state.instruments.lead.setProp({ property: 'volume', value })\n  })\n  modules.push(volume)\n  moduleMap['0/0'] = volume\n  moduleMap['1/0'] = volume\n  moduleMap['2/0'] = volume\n\n  const waveform1 = new ControlOptions(ctx, x+4*40, y, 'Waveform 1', ['square', 'sine','sawtooth'],\n  state.instruments.lead.waveform[0],\n  (value) => {\n    state.instruments.lead.setProp({ property: ['waveform', 0], value })\n  })\n  modules.push(waveform1)\n  moduleMap['4/0'] = waveform1\n  moduleMap['5/0'] = waveform1\n  moduleMap['6/0'] = waveform1\n  moduleMap['7/0'] = waveform1\n\n  const waveform2 = new ControlOptions(ctx, x+4*40, y+40, 'Waveform 2', ['square', 'sine','sawtooth'],\n  state.instruments.lead.waveform[1],\n  (value) => {\n    state.instruments.lead.setProp({ property: ['waveform', 1], value })\n  })\n  modules.push(waveform2)\n  moduleMap['4/1'] = waveform2\n  moduleMap['5/1'] = waveform2\n  moduleMap['6/1'] = waveform2\n  moduleMap['7/1'] = waveform2\n\n  const octave1 = new ControlOptions(ctx, x, y+40, 'Octave 1', [0.125, 0.25, 0.5, 1, 2],\n  state.instruments.lead.octave[0],\n  (value) => {\n    state.instruments.lead.setProp({ property: ['octave', 0], value })\n  })\n  modules.push(octave1)\n  moduleMap['0/1'] = octave1\n  moduleMap['1/1'] = octave1\n  moduleMap['2/1'] = octave1\n  moduleMap['3/1'] = octave1\n\n  const octave2 = new ControlOptions(ctx, x, y+80, 'Octave 2', [0.125, 0.25, 0.5, 1, 2],\n  state.instruments.lead.octave[1],\n  (value) => {\n    state.instruments.lead.setProp({ property: ['octave', 1], value })\n  })\n  modules.push(octave2)\n  moduleMap['0/2'] = octave2\n  moduleMap['1/2'] = octave2\n  moduleMap['2/2'] = octave2\n  moduleMap['3/2'] = octave2\n\n  const initialFilter = state.instruments.lead.filterValue\n  const filter = new ControlValue(ctx, x+40*10, y, 'Filter End', initialFilter, 10, (value) => {\n      state.instruments.lead.setProp({ property: 'filterValue', value })\n  })\n  modules.push(filter)\n  moduleMap['10/0'] = filter\n  moduleMap['11/0'] = filter\n  moduleMap['12/0'] = filter\n\n  const initialFrequencyValue = state.instruments.lead.initialFrequency\n  const initialFrequency = new ControlValue(ctx, x+40*8, y, 'Filter Start', initialFrequencyValue, 10, (value) => {\n      state.instruments.lead.setProp({ property: 'initialFrequency', value })\n  })\n  modules.push(initialFrequency)\n  moduleMap['8/0'] = initialFrequency\n  moduleMap['9/0'] = initialFrequency\n  moduleMap['10/0'] = initialFrequency\n\n  const filterType = new ControlOptions(ctx, x+11*40, y+40, 'Filter Type',\n  ['lowpass', 'highpass','bandpass', 'notch'],\n  state.instruments.lead.filterType,\n  (value) => {\n    state.instruments.lead.setProp({ property: 'filterType', value })\n  })\n  modules.push(filterType)\n  moduleMap['11/1'] = filterType\n  moduleMap['12/1'] = filterType\n  moduleMap['13/1'] = filterType\n  moduleMap['14/1'] = filterType\n\n  const initialQ = state.instruments.lead.Q\n  const controlQ = new ControlValue(ctx, x+40*8, y+40, 'Filter Q', initialQ, 10, (value) => {\n      state.instruments.lead.setProp({ property: 'Q', value: value })\n  })\n  modules.push(controlQ)\n  moduleMap['8/1'] = controlQ\n  moduleMap['9/1'] = controlQ\n  moduleMap['10/1'] = controlQ\n}\n","import Listener from './Listener'\nimport ControlValue from '../ui/InstrumentControlValue'\nimport ControlOptions from '../ui/InstrumentControlOptions'\n\nexport default class KeySynth extends Listener {\n  constructor(ctx){\n    super()\n    this.name = 'bass'\n    this.volume = 8\n    this.context = ctx\n    this.oscillators = {}\n    this.filterValue = 1\n    this.waveform = 'sawtooth'\n    this.playing = false\n  }\n  stopAll(){\n    if(!this.oscillators.osc1) return\n    this.oscillators.gain[0].gain.setTargetAtTime(0, this.context.currentTime+0.05, 0.1)\n    this.oscillators.gain[1].gain.setTargetAtTime(0, this.context.currentTime+0.05, 0.1)\n    this.oscillators.gain[2].gain.setTargetAtTime(0, this.context.currentTime+0.05, 0.1)\n    this.oscillators.osc1.stop(this.context.currentTime+1)\n    this.oscillators.osc2.stop(this.context.currentTime+1)\n    this.oscillators.osc3.stop(this.context.currentTime+1)\n    this.oscillators = {}\n    this.playing = false\n  }\n  makeOscillator(waveform){\n    const osc = this.context.createOscillator()\n    osc.type = waveform\n    return osc\n  }\n  getOscillators(note, oct){\n    const osc1 = this.makeOscillator('triangle')\n    const osc2 = this.makeOscillator(this.waveform)\n    const osc3 = this.makeOscillator(this.waveform)\n    const gain = [\n      this.context.createGain(), this.context.createGain(), this.context.createGain()\n    ]\n    const filters = [\n      this.context.createBiquadFilter(), this.context.createBiquadFilter()\n    ]\n    filters[0].frequency.value = this.filterValue * 500\n    filters[1].frequency.value = this.filterValue * 500\n\n    osc1.connect(gain[0])\n    osc2.connect(filters[0])\n    osc3.connect(filters[1])\n    filters[0].connect(gain[1])\n    filters[1].connect(gain[2])\n    gain.forEach(g => {\n      g.gain.value = (this.volume * 0.1) - (this.filterValue * 0.05)\n      g.connect(this.context.destination)\n    })\n\n    return [ osc1, osc2, osc3, gain, filters ]\n  }\n  play({ step, note, hold }){\n    if(step && !hold){\n      this.stopAll()\n      let [ osc1, osc2, osc3, gain, filters ] = this.getOscillators(note, step)\n      this.oscillators = {\n        osc1, osc2, osc3,\n        gain, filters\n      }\n      filters[0].frequency.setTargetAtTime(0, this.context.currentTime+0.02, 0.2)\n      filters[1].frequency.setTargetAtTime(0, this.context.currentTime+0.02, 0.2)\n      osc1.start()\n      osc2.start()\n      osc3.start()\n      this.playing = true\n    }\n    if((step && this.playing) || (hold && step && this.playing && this.oscillators.osc1)){\n      this.oscillators.osc1.frequency.value = 55 * step\n      this.oscillators.osc2.frequency.value = 55 * step\n      this.oscillators.osc3.frequency.value = 110 * step\n      this.oscillators.osc1.detune.value = 99  * note\n      this.oscillators.osc2.detune.value = 101 * note\n      this.oscillators.osc3.detune.value = 100 * note\n    }\n    if(!step){\n      this.stopAll()\n    }\n  }\n}\n\nexport const bassControlFunction = (state, modules, moduleMap, ctx, x, y) => {\n  const initialVolume = state.instruments.bass.volume\n  const volume = new ControlValue(ctx, x, y, 'Volume', initialVolume, 10, (value) => {\n      state.instruments.bass.setProp({ property: 'volume', value })\n  })\n  modules.push(volume)\n  moduleMap['0/0'] = volume\n  moduleMap['1/0'] = volume\n  moduleMap['2/0'] = volume\n\n  const initialFilter = state.instruments.bass.filterValue\n  const filter = new ControlValue(ctx, x+3*40, y, 'Filter', initialFilter, 20, (value) => {\n      state.instruments.bass.setProp({ property: 'filterValue', value })\n  })\n  modules.push(filter)\n  moduleMap['3/0'] = filter\n  moduleMap['4/0'] = filter\n  moduleMap['5/0'] = filter\n\n  const waveform = new ControlOptions(ctx, x+7*40, y, 'Waveform', ['triangle', 'square','sawtooth'],\n  state.instruments.bass.waveform,\n  (value) => {\n    state.instruments.bass.setProp({ property: 'waveform', value })\n  })\n  modules.push(waveform)\n  moduleMap['7/0'] = waveform\n  moduleMap['8/0'] = waveform\n  moduleMap['9/0'] = waveform\n  moduleMap['10/0'] = waveform\n\n}\n","import Listener from './Listener'\nimport ControlValue from '../ui/InstrumentControlValue'\nimport ControlOptions from '../ui/InstrumentControlOptions'\n\nconst fmModeMethods = {\n  'parallel': 'setupOscillators_A',\n  'vertical': 'setupOscillators_B'\n}\n\nexport default class fmSynth extends Listener {\n  constructor(ctx){\n    super()\n    this.volume = 8\n    this.mod1Oct = 0\n    this.mod2Oct = 0\n    this.context = ctx\n    this.decay = 1\n    this.prevOsc = null\n    this.oscillators = {}\n    this.playing = false\n    this.waveformOptions = ['square', 'sine', 'sawtooth']\n    this.waveform = 'square'\n    this.fmMode = 'parallel'\n  }\n  storeOscillators(data){\n    Object.keys(data).forEach(key => {\n      this.oscillators[key] = data[key]\n    })\n  }\n  stopAll(){\n    if(!this.oscillators.osc1) return\n    this.oscillators.gainNode1.gain.setTargetAtTime(0, this.context.currentTime+(this.decay*0.01), 0.05);\n    this.oscillators.gainNode2.gain.setTargetAtTime(0, this.context.currentTime+(this.decay*0.01), 0.05);\n    this.oscillators.osc1.stop(this.context.currentTime+1)\n    this.oscillators.osc2.stop(this.context.currentTime+1)\n    this.oscillators.modulator1.stop(this.context.currentTime+1)\n    this.oscillators.modulator2.stop(this.context.currentTime+1)\n    this.oscillators.modulatorA.stop(this.context.currentTime+1)\n    this.oscillators.modulatorB.stop(this.context.currentTime+1)\n    this.oscillators = {}\n    this.playing = false\n  }\n  getModulator(oct, wave, gain){\n    const modulator = this.context.createOscillator()\n    const modulatorGain = this.context.createGain()\n    modulator.type = wave\n    modulator.frequency.value = oct\n    modulatorGain.gain.value = gain\n    modulator.connect(modulatorGain)\n    return [ modulator, modulatorGain ]\n  }\n  getOscillator(pan){\n    const osc = this.context.createOscillator()\n    osc.type = this.waveform\n\n    const gainNode = this.context.createGain()\n    gainNode.gain.value = this.volume * 0.02\n\n    const panNode = this.context.createStereoPanner()\n\n    let panValue = 0\n    if(pan === 'left') panValue = -0.7\n    if(pan === 'right') panValue = 0.7\n    panNode.pan.value = panValue\n\n    const filter = this.context.createBiquadFilter();\n    filter.type = 'lowpass';\n    filter.frequency.value = 0;\n\n    osc.connect(filter)\n    filter.connect(gainNode)\n    gainNode.connect(panNode)\n    panNode.connect(this.context.destination)\n    return [ osc, filter, gainNode ]\n  }\n  setupOscillators_A(){\n    const [ osc1, filter1, gainNode1 ] = this.getOscillator('left')\n    const [ osc2, filter2, gainNode2 ] = this.getOscillator('right')\n    const [ modulatorA, modulatorGainA ] = this.getModulator(5.5*(this.mod1Oct*5), 'sawtooth', 70)\n    const [ modulatorB, modulatorGainB ] = this.getModulator(5.5*(this.mod2Oct*10), 'sine', 90)\n    const [ modulator1, modulatorGain1 ] = this.getModulator(5.5*(this.mod1Oct*5), 'sawtooth', 50)\n    const [ modulator2, modulatorGain2 ] = this.getModulator(5.5*(this.mod2Oct*10), 'sine', 40)\n    modulatorGainA.connect(modulator1.frequency)\n    modulatorGainB.connect(modulator2.frequency)\n    modulatorGain1.connect(osc1.frequency)\n    modulatorGain2.connect(osc2.frequency)\n    return [\n      osc1, osc2,\n      gainNode1, gainNode2,\n      modulatorA, modulatorB,\n      modulator1, modulator2,\n      filter1, filter2\n     ]\n  }\n  setupOscillators_B(){\n    const [ osc1, filter1, gainNode1 ] = this.getOscillator()\n    const [ osc2, filter2, gainNode2 ] = this.getOscillator()\n    const [ modulatorA, modulatorGainA ] = this.getModulator(5.5*(this.mod1Oct*5), 'square', 35)\n    const [ modulatorB, modulatorGainB ] = this.getModulator(5.5*(this.mod2Oct*10), 'sine', 50)\n    const [ modulator1, modulatorGain1 ] = this.getModulator(5.5*(this.mod1Oct*5), 'sine', 30)\n    const [ modulator2, modulatorGain2 ] = this.getModulator(5.5*(this.mod2Oct*10), 'sine', 35)\n    modulatorGainA.connect(modulator1.frequency)\n    modulatorGain1.connect(modulatorB.frequency)\n    modulatorGainB.connect(osc1.frequency)\n    gainNode1.connect(osc2.frequency)\n    return [\n      osc1, osc2,\n      gainNode1, gainNode2,\n      modulatorA, modulatorB,\n      modulator1, modulator2,\n      filter1, filter2\n     ]\n  }\n  play({ step, note, hold }){\n    if(step && !hold){\n      this.stopAll()\n      const methodName = fmModeMethods[this.fmMode]\n      const [\n        osc1, osc2,\n        gainNode1, gainNode2,\n        modulatorA, modulatorB,\n        modulator1, modulator2,\n        filter1, filter2\n      ] = this[methodName](note, step)\n      this.storeOscillators({\n        osc1, osc2,\n        modulatorA, modulatorB,\n        modulator1, modulator2,\n        gainNode1, gainNode2\n      })\n      modulatorA.start()\n      modulatorB.start()\n      modulator1.start()\n      modulator2.start()\n      osc1.start()\n      osc2.start()\n      filter1.frequency.setTargetAtTime(5000, this.context.currentTime, 0.03)\n      filter2.frequency.setTargetAtTime(5000, this.context.currentTime, 0.03)\n      this.playing = true\n    }\n    if((step && this.playing) || (hold && step && this.playing)){\n      this.oscillators.osc1.detune.value = note*101\n      this.oscillators.osc1.frequency.value = step*220\n      this.oscillators.osc2.detune.value = note*99\n      this.oscillators.osc2.frequency.value = step*220\n    }\n    if(!step && this.oscillators.osc1){\n      this.stopAll()\n    }\n  }\n}\n\nexport const fmControlFunction = (state, modules, moduleMap, ctx, x, y) => {\n  const initialVolume = state.instruments.fm.volume\n  const volume = new ControlValue(ctx, x, y, 'Volume', initialVolume, 10, (value) => {\n      state.instruments.fm.setProp({ property: 'volume', value })\n  })\n  modules.push(volume)\n  moduleMap['0/0'] = volume\n  moduleMap['1/0'] = volume\n  moduleMap['2/0'] = volume\n\n  const initialDecay = state.instruments.fm.decay\n  const decay = new ControlValue(ctx, x, y+40, 'Decay', initialDecay, 9, (value) => {\n      if(value === 0) value += 1\n      state.instruments.fm.setProp({ property: 'decay', value })\n  })\n  modules.push(decay)\n  moduleMap['0/1'] = decay\n  moduleMap['1/1'] = decay\n  moduleMap['2/1'] = decay\n\n  const waveform = new ControlOptions(ctx, x+3*40, y, 'Waveform', ['square', 'sine','sawtooth'],\n  state.instruments.fm.waveform,\n  (value) => {\n    state.instruments.fm.setProp({ property: 'waveform', value })\n  })\n  modules.push(waveform)\n  moduleMap['3/0'] = waveform\n  moduleMap['4/0'] = waveform\n  moduleMap['5/0'] = waveform\n  moduleMap['6/0'] = waveform\n\n  const fmMode = new ControlOptions(ctx, x+3*40, y+40, 'FM Mode', ['vertical', 'parallel'],\n  state.instruments.fm.fmMode,\n  (value) => {\n    state.instruments.fm.setProp({ property: 'fmMode', value })\n  })\n  modules.push(fmMode)\n  moduleMap['3/1'] = fmMode\n  moduleMap['4/1'] = fmMode\n  moduleMap['5/1'] = fmMode\n  moduleMap['6/1'] = fmMode\n\n  const initialMod1Oct = state.instruments.fm.mod1Oct\n  const mod1Oct = new ControlValue(ctx, x+7*40, y, 'Mod1 Oct', initialMod1Oct, 5, (value) => {\n      state.instruments.fm.setProp({ property: 'mod1Oct', value })\n  })\n  modules.push(mod1Oct)\n  moduleMap['7/0'] = mod1Oct\n  moduleMap['8/0'] = mod1Oct\n  moduleMap['9/0'] = mod1Oct\n\n  const initialMod2Oct = state.instruments.fm.mod2Oct\n  const mod2Oct = new ControlValue(ctx, x+7*40, y+40, 'Mod2 Oct', initialMod2Oct, 5, (value) => {\n      state.instruments.fm.setProp({ property: 'mod2Oct', value })\n  })\n  modules.push(mod2Oct)\n  moduleMap['7/1'] = mod2Oct\n  moduleMap['8/1'] = mod2Oct\n  moduleMap['9/1'] = mod2Oct\n}\n","import Listener from './Listener'\nimport ControlValue from '../ui/InstrumentControlValue'\n\nexport default class Snare extends Listener {\n  constructor(ctx){\n    super()\n    this.volume = 8\n    this.context = ctx\n    this.config = {\n      type: 'triangle'\n    }\n    this.buffer = noiseBuffer(ctx)\n  }\n  setVolume(value){\n    this.volume = value\n  }\n  stopAll(){}\n  getNoise(){\n    const noise = this.context.createBufferSource();\n    noise.buffer = this.buffer\n\n    const noiseFilter = this.context.createBiquadFilter();\n    noiseFilter.type = 'highpass';\n    noiseFilter.frequency.value = 1000;\n\n    const noiseEnvelope = this.context.createGain();\n    noiseEnvelope.gain.value = this.volume * 0.1\n\n    noise.connect(noiseFilter);\n    noiseFilter.connect(noiseEnvelope);\n    noiseEnvelope.connect(this.context.destination);\n    return [ noise, noiseEnvelope ]\n  }\n  getOscillators(){\n  const osc = this.context.createOscillator();\n  osc.type = this.config.type;\n  osc.frequency.value = 150\n\n  const gain = this.context.createGain()\n  gain.gain.value = this.volume * 0.1\n  osc.connect(gain);\n  gain.connect(this.context.destination);\n  return [ osc, gain ]\n  }\n  play({ step }){\n    if(step){\n      const [ osc, gain ] = this.getOscillators()\n      const [ noise, noiseEnvelope ] = this.getNoise()\n      osc.start()\n      noise.start()\n      gain.gain.setTargetAtTime(0, this.context.currentTime, 0.04);\n      noiseEnvelope.gain.setTargetAtTime(0, this.context.currentTime, 0.03);\n      osc.stop(this.context.currentTime + 0.30)\n      noise.stop(this.context.currentTime + 0.30)\n    }\n  }\n}\n\nfunction noiseBuffer(context) {\n  const bufferSize = context.sampleRate;\n  const buffer = context.createBuffer(1, bufferSize, context.sampleRate);\n  const output = buffer.getChannelData(0);\n  for (var i = 0; i < bufferSize; i++) {\n    output[i] = Math.random() * 2 - 1;\n  }\n  return buffer;\n};\n\nexport const snareControlFunction = (state, modules, moduleMap, ctx, x, y) => {\n  const initialVolume = state.instruments.snare.volume\n  const volume = new ControlValue(ctx, x, y, 'Volume', initialVolume, 10, (value) => {\n      state.instruments.snare.setProp({ property: 'volume', value })\n  })\n  modules.push(volume)\n  moduleMap['0/0'] = volume\n  moduleMap['1/0'] = volume\n  moduleMap['2/0'] = volume\n}\n","import Listener from './Listener'\nimport ControlValue from '../ui/InstrumentControlValue'\n\nexport default class Hat extends Listener {\n  constructor(ctx){\n    super()\n    this.volume = 8\n    this.context = ctx\n    this.prevOsc = null\n    this.buffer = noiseBuffer(ctx)\n  }\n  getNoise(){\n    const noise = this.context.createBufferSource();\n    noise.buffer = this.buffer\n    const noiseFilter = this.context.createBiquadFilter();\n    noiseFilter.type = 'highpass';\n    noiseFilter.frequency.value = 2500;\n    noise.connect(noiseFilter);\n\n    const noiseEnvelope = this.context.createGain();\n    noiseEnvelope.gain.value = this.volume * 0.1\n    noiseFilter.connect(noiseEnvelope);\n    noiseEnvelope.connect(this.context.destination);\n    return [ noise, noiseEnvelope ]\n  }\n  stopAll(){\n    if(this.prevOsc){\n      this.prevOsc.stop(0)\n    }\n  }\n  play({ step }){\n    if(step){\n      this.stopAll()\n      const time = step === 1 ? 0.01 : 0.05\n      const [ noise, noiseEnvelope ] = this.getNoise()\n      this.prevOsc = noise\n      noise.start(0)\n      noiseEnvelope.gain.setTargetAtTime(0, this.context.currentTime, time);\n      noise.stop(this.context.currentTime + 0.30)\n    }\n  }\n}\n\nfunction noiseBuffer(context) {\n  const bufferSize = context.sampleRate;\n  const buffer = context.createBuffer(1, bufferSize, context.sampleRate);\n  const output = buffer.getChannelData(0);\n  for (var i = 0; i < bufferSize; i++) {\n    output[i] = Math.random() * 2 - 1;\n  }\n  return buffer;\n};\n\nexport const hatControlFunction = (state, modules, moduleMap, ctx, x, y) => {\n  const initialVolume = state.instruments.hat.volume\n  const volume = new ControlValue(ctx, x, y, 'Volume', initialVolume, 10, (value) => {\n      state.instruments.hat.setProp({ property: 'volume', value })\n  })\n  modules.push(volume)\n  moduleMap['0/0'] = volume\n  moduleMap['1/0'] = volume\n  moduleMap['2/0'] = volume\n}\n","export const COLOR = 'white'\nexport const LOOP_LENGTH = 16\nexport const SEQUENCE_LENGTH = 4","import KickSynth from './instruments/kick'\nimport LeadSynth from './instruments/leadSynth'\nimport BassSynth from './instruments/synth'\nimport fm from './instruments/fm'\nimport Snare from './instruments/snare'\nimport Hat from './instruments/hat'\nimport { LOOP_LENGTH, SEQUENCE_LENGTH } from './constants'\n\nfunction makeStepArray(steps){\n  let empty = []\n  empty.length = steps\n  empty.fill(undefined)\n  let arr = empty.map(item => ({ step: 0, note: 0, hold: false }))\n  return arr\n}\n\nexport default class State {\n  constructor(audioCtx) {\n    this.swingIsOn = false\n    this.isPlaying = false\n    this.tempo = 120\n    this.viewPage = 0\n    this.playPage = 0\n    this.sequenceIndex = 0\n    this.sequence = [0, 0, 0, 0]\n    this.blocks = {}\n    this.blinkers = []\n    this.children = []\n    this.steps = {\n      bass: [makeStepArray(16),makeStepArray(16), makeStepArray(16), makeStepArray(16)],\n      kick: [makeStepArray(16),makeStepArray(16), makeStepArray(16), makeStepArray(16)],\n      snare: [makeStepArray(16),makeStepArray(16), makeStepArray(16), makeStepArray(16)],\n      lead: [makeStepArray(16),makeStepArray(16), makeStepArray(16), makeStepArray(16)],\n      fm: [makeStepArray(16),makeStepArray(16), makeStepArray(16), makeStepArray(16)],\n      hat: [makeStepArray(16),makeStepArray(16), makeStepArray(16), makeStepArray(16)]\n    }\n    this.copyBuffer = { notes: {}, steps: {} }\n    this.step = 0\n    this.context = audioCtx\n    this.instruments = {\n      bass: new BassSynth(audioCtx),\n      kick: new KickSynth(audioCtx),\n      snare: new Snare(audioCtx),\n      fm: new fm(audioCtx),\n      lead: new LeadSynth(audioCtx),\n      hat: new Hat(audioCtx)\n    }\n  }\n  push(child){\n    this.children.push(child)\n    return child\n  }\n  trigger(message){\n    switch (message.type) {\n      case 'get_page': return this.steps[message.instrument][this.viewPage]\n      case 'toggle_swing': return this.swingIsOn = !this.swingIsOn\n      case 'set_page':\n        this.viewPage = message.page\n        this.drawScreen()\n        return message.page\n      case 'copy_page': return this.copyPage()\n      case 'paste_page': return this.pastePage()\n      case 'set_sequence': return this.setSequence(message.sequence)\n    }\n  }\n  toggleStep(idx, type, values){\n    this.steps[type][this.viewPage][idx].step = (this.steps[type][this.viewPage][idx].step + 1) % values\n  }\n  togglePlay(){\n    this.isPlaying = !this.isPlaying\n\n    if(this.isPlaying){\n      this.context.resume().then(() => {\n        this.noteTime = 0.0\n        this.startTime = this.context.currentTime + 0.005\n        this.rhythmIndex = 0\n        this.previousRhythmIndex = null\n        return this.schedule()\n      })\n    } else {\n      return this.stop()\n    }\n  }\n  setSequence(sequence){\n    this.sequence = sequence\n  }\n  copyPage(){\n    Object.keys(this.steps).forEach(stepKey => {\n      this.copyBuffer.steps[stepKey] = this.steps[stepKey][this.viewPage].slice().map(step => Object.assign({}, step))\n    })\n  }\n  pastePage(){\n    Object.keys(this.steps).forEach(stepKey => {\n      this.steps[stepKey][this.viewPage] = this.copyBuffer.steps[stepKey].slice()\n    })\n    this.drawScreen()\n  }\n  schedule(){\n    let currentTime = this.context.currentTime\n    currentTime -= this.startTime\n    const nextTime = currentTime + 0.200\n    while (this.noteTime < nextTime) {\n      var contextPlayTime = this.noteTime + this.startTime\n      if (this.viewPage === this.playPage) {\n        this.blinkers[this.rhythmIndex].toggle()\n      }\n      if(this.previousRhythmIndex !== null) this.blinkers[this.previousRhythmIndex].toggle(false)\n      /* for each instrument pass the step object for this page and beat into the play method */\n      Object.keys(this.steps).forEach(type => {\n        this.instruments[type].play(this.steps[type][this.playPage][this.rhythmIndex])\n      })\n      this.advanceNote()\n    }\n    this.interval = setTimeout(() => { this.schedule() }, 0)\n  }\n  advanceNote(){\n    let secondsPerBeat = 60 / this.tempo\n    this.previousRhythmIndex = this.rhythmIndex\n    this.rhythmIndex++;\n    if (this.rhythmIndex === LOOP_LENGTH) {\n      this.rhythmIndex = 0;\n      this.sequenceIndex = (this.sequenceIndex + 1) % SEQUENCE_LENGTH\n      this.playPage = this.sequence[this.sequenceIndex]\n      this.drawScreen()\n    }\n    if(this.swingIsOn){\n      this.noteTime += this.rhythmIndex % 2 ? 0.32 * secondsPerBeat : 0.18 * secondsPerBeat\n    } else {\n      this.noteTime += 0.25 * secondsPerBeat\n    }\n  }\n  stop(){\n    Object.keys(this.instruments).forEach(key => {\n      this.instruments[key].stopAll()\n    })\n    this.blinkers[this.previousRhythmIndex].toggle()\n    window.clearInterval(this.interval)\n    this.context.suspend()\n  }\n  drawScreen(){\n    this.children.forEach(child => child.render())\n  }\n}\n","export default class Word {\n  constructor(word, ctx, x, y, handleClick){\n    this.context = ctx\n    this.word = word\n    this.x = x\n    this.y = y\n    this.handleClick = handleClick || function(){}\n  }\n  render(){\n    this.context.clearRect(this.x, this.y, 40, 40)\n    this.context.fillStyle = 'green'\n    this.context.fillText(this.word, this.x+3, this.y+25, 80);\n  }\n}\n","export default class Button {\n  constructor(text, ctx, x, y, handleClick){\n    this.x = x\n    this.y = y\n    this.text = text\n    this.textWidth = Math.ceil(ctx.measureText(text).width)\n    this.width = Math.ceil((this.textWidth+10)/40) * 40\n    this.toggled = false\n    this.context = ctx\n    this.callBack = handleClick\n  }\n  handleClick(x, y){\n    this.toggled = !this.toggled\n    this.callBack(this.toggled)\n    this.render()\n  }\n  render(){\n    this.context.clearRect(this.x, this.y, this.width, 40)\n    this.context.fillStyle = 'black'\n      this.context.fillRect(this.x, this.y, this.width, 40)\n      if(this.isToggled ? this.isToggled() : this.toggled){\n        this.context.fillStyle = '#999'\n        this.context.fillRect(this.x+1, this.y, this.width-2, 39)\n      } else {\n        this.context.clearRect(this.x+1, this.y+1, this.width-2, 39)\n      }\n      this.context.fillStyle = 'black'\n      const wordMargin = (this.width/2)-(this.textWidth/2)\n      this.context.fillText(this.text, this.x+wordMargin, this.y+25, this.width+3);\n  }\n}\n","import { COLOR } from '../constants'\n\nexport class BinSwitch {\n  constructor(idx, state, ctx){\n    this.idx = idx\n    this.state = state\n    this.context = ctx\n    this.x = null\n    this.y = null\n    this.colors = ['black', 'red']\n  }\n  render(){\n    const page = this.state.getPage()\n    this.context.fillStyle = this.colors[page[this.idx].step]\n    this.context.fillRect(this.x, this.y, 39, 39)\n    this.context.fillStyle = COLOR\n  }\n  setPos(x, y){\n    this.x = x\n    this.y = y\n  }\n  handleClick(){\n    const page = this.state.getPage()\n    this.value = (this.value+1) % 2\n    page[this.idx].step = this.value\n    this.context.clearRect(this.x, this.y, 39, 39)\n    this.context.fillStyle = this.colors[page[this.idx].step]\n    this.context.fillRect(this.x, this.y, 39, 39)\n    this.context.fillStyle = COLOR\n  }\n}\n\nexport class OctaveSwitch {\n  constructor(idx, state, ctx, x, y){\n    this.idx = idx\n    this.state = state\n    this.context = ctx\n    this.x = x\n    this.y = y\n    this.colors = ['black', 'red', 'blue']\n  }\n  render(){\n    const page = this.state.getPage()\n    this.context.fillStyle = this.colors[page[this.idx].step]\n    this.context.fillRect(this.x, this.y, 39, 39)\n    this.context.fillStyle = page[this.idx].hold ? 'green' : 'yellow'\n    this.context.fillRect(this.x, this.y, 10, 10)\n    this.context.fillStyle = COLOR\n  }\n  handleClick(x, y, innerX, innerY){\n    const isHold = innerX <= 10 && innerY <= 10\n    const page = this.state.getPage()\n    if(isHold){\n      page[this.idx].hold = !page[this.idx].hold\n    } else {\n      this.value = (page[this.idx].step+1) % 3\n      page[this.idx].step = this.value\n    }\n    this.context.clearRect(this.x, this.y, 39, 39)\n    this.render()\n  }\n}\n","export default class Blinker {\n  constructor(i, state, ctx, x, y){\n    this.context = ctx\n    state.blinkers[i] = this\n    this.idx = i\n    this.on = false\n    this.x = x\n    this.y = y\n  }\n  render(){\n    if(this.on || this.idx % 4 === 0){\n      this.drawCircle()\n    } else {\n      this.context.clearRect(this.x-1, this.y-1, 39, 39)\n    }\n  }\n  drawCircle(){\n    this.context.beginPath();\n    this.context.arc(this.x+20, this.y+20, 8, 0, 2 * Math.PI, false);\n    this.context.fillStyle = this.idx % 4 ? 'red' : 'blue';\n    this.context.fill();\n    this.context.lineWidth = 1;\n    this.context.strokeStyle = '#003300';\n    this.context.stroke();\n  }\n  handleClick(){}\n  toggle(value){\n    this.on = value !== undefined ? value : !this.on\n    this.render()\n  }\n}\n","export default class Note {\n  constructor(idx, parent, context, x, y){\n    this.notes = ['c','c#','d','d#','e','f','f#','g','g#','a','a#','b'],\n    this.parent = parent\n    this.context = context\n    this.idx = idx\n    this.x = x\n    this.y = y\n  }\n  render(){\n    this.context.fillStyle = 'black'\n    this.context.fillRect(this.x, this.y, 40, 40)\n    this.context.clearRect(this.x+1, this.y+1, 38, 38)\n    const page = this.parent.getPage()\n    const noteIndex = page[this.idx].note\n    this.context.fillText(this.notes[noteIndex], this.x+15, this.y+25, 15);\n  }\n  handleClick(){\n    const page = this.parent.getPage()\n    page[this.idx].note = page[this.idx].note === 11 ? 0 : page[this.idx].note+1\n    this.render()\n  }\n}\n","import { bassControlFunction } from './synth'\nimport { leadControlFunction } from './leadSynth'\nimport { fmControlFunction } from './fm'\nimport { kickControlFunction } from './kick'\nimport { hatControlFunction } from './hat'\nimport { snareControlFunction } from './snare'\n\nconst map = {\n  'bass': bassControlFunction,\n  'lead': leadControlFunction,\n  'fm': fmControlFunction,\n  'kick': kickControlFunction,\n  'hat': hatControlFunction,\n  'snare': snareControlFunction\n}\n\nexport default map\n","import State from './state'\nimport PlayBtn from './ui/PlayBtn'\nimport BeatMarker from './ui/BeatMarker'\nimport Word from './ui/Word'\nimport Options from './ui/Options'\nimport PageButton from './ui/PageButton'\nimport Tempo from './ui/Tempo'\nimport Button from './ui/Button'\nimport InstrumentWindow from './ui/InstrumentWindow'\nimport SequenceList from './ui/SequenceList'\n\nconst canvas = document.getElementById('synth');\nconst ctx = canvas.getContext('2d');\nctx.font = '14px sans-serif'\nconst audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n\nconst state = new State(audioCtx)\n\n/* Play button */\nconst playBtn = state.push(new PlayBtn(ctx, state, 0, 0))\nstate.blocks['0/0'] = playBtn\n\n\n/* Page controls */\nconst pageButton = state.push(new PageButton(state, ctx, 2*40, 0))\nstate.blocks['2/0'] = pageButton\nstate.blocks['3/0'] = pageButton\nstate.blocks['4/0'] = pageButton\nstate.blocks['5/0'] = pageButton\n\nconst sequenceControl = state.push(new SequenceList(state, ctx, 2*40, 40))\nstate.blocks['2/1'] = sequenceControl\nstate.blocks['3/1'] = sequenceControl\nstate.blocks['4/1'] = sequenceControl\nstate.blocks['5/1'] = sequenceControl\n\nstate.blocks['7/0'] = state.push(new Word('Copy', ctx, 7*40, 0, () => state.trigger({ type: 'copy_page'})))\nstate.blocks['8/0'] = state.push(new Word('Paste', ctx, 8*40, 0, () => state.trigger({ type: 'paste_page'})))\n/* Tempo */\nconst tempo = state.push(new Tempo(state, ctx, 11*40, 0))\nstate.blocks['11/0'] = tempo\nstate.blocks['12/0'] = tempo\n\nconst toggleSwing = () => state.trigger({ type: 'toggle_swing' })\nconst swingToggle = state.push(new Options({ options: ['straight', 'swing'], cb: toggleSwing, ctx, x: 14*40, y: 0 }))\nstate.blocks['14/0'] = swingToggle\nstate.blocks['15/0'] = swingToggle\n\nconst instrumentWindow = state.push(new InstrumentWindow(state, ctx, 4*40, 3*40))\nfor(let i = 4; i < 20; i++){\n  for(let k = 3; k < 16; k++){\n    state.blocks[`${i}/${k}`] = instrumentWindow\n  }\n}\n\nconst instruments = ['fm', 'bass','lead', 'kick', 'snare', 'hat']\nlet startX = 4*40\n\nfor(let i = 0; i < instruments.length; i++){\n  let btn = new Button(instruments[i], ctx, startX, 80, (on) => {\n    instrumentWindow.setInstrument(instruments[i])\n  })\n  btn.isToggled = () => instrumentWindow.instrument === instruments[i]\n  state.push(btn)\n  for(let k = 0; k <= Math.floor(btn.width/40); k++){\n    state.blocks[`${Math.ceil(startX/40) + k}/2`] = btn\n  }\n  startX = startX + btn.width\n}\n\ncanvas.onclick = function (e) {\n  let totalOffsetX = 0;\n  let totalOffsetY = 0;\n  let canvasX = 0;\n  let canvasY = 0;\n  let currentElement = this;\n  do {\n    totalOffsetX += currentElement.offsetLeft - currentElement.scrollLeft\n    totalOffsetY += currentElement.offsetTop - currentElement.scrollTop\n  } while(currentElement = currentElement.offsetParent)\n  canvasX = e.pageX - totalOffsetX - window.scrollX;\n  canvasY = e.pageY - totalOffsetY - window.scrollY;\n\n  let x = Math.floor(canvasX/40)\n  let y = Math.floor(canvasY/40)\n  let innerX = canvasX - (x * 40)\n  let innerY = canvasY - (y * 40)\n  const key = `${x}/${y}`\n  const module = state.blocks[key]\n  if(module){\n    state.blocks[key].handleClick(x, y, innerX, innerY)\n  }\n}\n\nconst pageKeys = ['Digit1', 'Digit2', 'Digit3', 'Digit4']\n\nwindow.onkeydown = function(e){\n  if(e.code){\n    if(e.code === 'Space'){\n      state.togglePlay()\n      playBtn.render()\n    } else if(pageKeys.indexOf(e.code) !== -1){\n      const page = parseInt(e.code.split('Digit')[1]) - 1\n      state.trigger({ type: 'set_page', page })\n    } else if(e.code === 'BracketLeft' || e.code === 'BracketRight'){\n      let instrumentIdx = instruments.indexOf(instrumentWindow.instrument)\n      if(e.code === 'BracketLeft' && instrumentIdx > 0) instrumentIdx -= 1\n      if(e.code === 'BracketRight' && instrumentIdx < instruments.length-1) instrumentIdx += 1\n      instrumentWindow.setInstrument(instruments[instrumentIdx])\n    } else if(e.code === 'KeyC'){\n      state.trigger({ type: 'copy_page'})\n    } else if(e.code === 'KeyV'){\n      state.trigger({ type: 'paste_page'})\n    }\n  }\n}\n\nstate.drawScreen()\n","export default class PlayBtn {\n  constructor(ctx, state, x, y){\n    this.context = ctx\n    this.state = state\n    this.x = x\n    this.y = y\n    this.on = state.isPlaying\n  }\n  render(){\n    this.on = this.state.isPlaying\n    this.context.fillStyle = this.on ? 'red' : 'green'\n    this.context.fillRect(this.x, this.y, 40, 40)\n    this.context.fillStyle = this.on ? 'black' : 'white'\n    this.context.fillText(this.on ? 'STOP' : 'PLAY', this.x+1, this.y+25, 80);\n  }\n  handleClick(){\n    this.state.togglePlay()\n    this.on = this.state.isPlaying\n    this.render()\n  }\n}\n","export default class PageButton {\n  constructor(state, ctx, x, y, handleClick){\n    this.context = ctx\n    this.state = state\n    this.pageOne = x/40\n    this.x = x\n    this.y = y\n    this.value = 0\n    this.callBack = handleClick\n  }\n  handleClick(x, y){\n    const buttonIdx = x - this.pageOne\n    this.value = buttonIdx\n    this.state.trigger({ type: 'set_page', page: this.value })\n    this.render()\n  }\n  render(){\n    this.value = this.state.viewPage // reset page btn to top level page value\n    this.context.fillStyle = 'black'\n    for(let i = 0; i < 4; i++){\n      const offset = 40 * i\n      const name = `Pg ${i+1}`\n      this.context.fillRect(this.x+offset, this.y, 40, 40)\n      if(i === this.value){\n        this.context.fillStyle = '#999'\n        this.context.fillRect(this.x+offset+1, this.y, 39-(i === 3 ? 1 : 0), 39)\n      } else {\n        this.context.clearRect(this.x+offset+1, this.y, 39-(i === 3 ? 1 : 0), 39)\n      }\n      this.context.fillStyle = 'black'\n      this.context.fillText(name, this.x+offset+3, this.y+25, 80);\n    }\n  }\n}\n","export default class SequenceList {\n  constructor(state, ctx, x, y, handleClick){\n    this.context = ctx\n    this.state = state\n    this.pageOne = x/40\n    this.x = x\n    this.y = y\n    this.value = [0, 0, 0, 0]\n    this.callBack = handleClick\n  }\n  handleClick(x, y){\n    const buttonIdx = x - this.pageOne\n    this.value[buttonIdx] = (this.value[buttonIdx] + 1) % 4;\n    this.state.trigger({ type: 'set_sequence', sequence: this.value })\n    this.render()\n  }\n  render(){\n    this.context.clearRect(this.x, this.y, 40, 160)\n    this.context.fillStyle = 'black'\n    for(let i = 0; i < 4; i++){\n      const offset = 40 * i\n      const name = `${this.value[i]+1}`\n      this.context.fillRect(this.x+offset, this.y, 40, 40)\n      this.context.clearRect(this.x+offset+1, this.y, 39-(i === 3 ? 1 : 0), 39)\n      if (this.state.sequenceIndex === i) {\n        this.context.beginPath();\n        this.context.arc(this.x+(40*i)+6, this.y+6, 4, 0, 2 * Math.PI, false);\n        this.context.fillStyle = 'blue'\n        this.context.fill();\n      }\n      this.context.fillStyle = 'black'\n      this.context.fillText(name, this.x+offset+17, this.y+25, 80);\n    }\n  }\n}\n","export default class PlayBtn {\n  constructor(state, ctx, x, y){\n    this.context = ctx\n    this.state = state\n    this.x = x\n    this.y = y\n  }\n  render(){\n    const tempoText = `${this.state.tempo}/bpms`\n    this.context.fillStyle = 'black'\n    this.context.clearRect(this.x, this.y, 65, 40)\n    this.context.fillText('+', this.x+25, this.y+10, 80);\n    this.context.fillText('-', this.x+26, this.y+40, 80);\n    this.context.fillText(tempoText, this.x, this.y+25, 80);\n  }\n  handleClick(x, y, innerX, innerY){\n    const section = Math.floor(innerY/20)\n    this.state.tempo = section ? this.state.tempo-1 : this.state.tempo+1\n    this.render()\n  }\n}\n","import BassSynth from '../instruments/synth'\nimport { BinSwitch, OctaveSwitch } from './switch'\nimport Blinker from './Blinker'\nimport Note from './note'\nimport instrumentControlFunctions from '../instruments/instrumentControlFunctions'\n\nexport default class InstrumentWindow {\n  constructor(state, ctx, x, y){\n    this.x = x\n    this.y = y\n    this.parent = state\n    this.context = ctx\n    this.instrument = 'bass'\n    this.instrumentControlMap = {}\n    this.moduleMap = {}\n    this.children = []\n    this.instrumentControls = []\n    this.build()\n  }\n  push(child){\n    this.children.push(child)\n    return child\n  }\n  build(){\n    for(var i = 0; i < 16; i++){\n      this.moduleMap[`${i}/9`] = this.push(new Note(i, this, this.context, this.x+i*40, this.y+9*40))\n      this.moduleMap[`${i}/10`] = this.push(new OctaveSwitch(i, this, this.context, this.x+i*40, this.y+10*40))\n      this.moduleMap[`${i}/11`] = this.push(new Blinker(i, this.parent, this.context, this.x+i*40, this.y+11*40))\n    }\n    this.buildInstrumentControls()\n  }\n  buildInstrumentControls(){\n    instrumentControlFunctions[this.instrument](\n      this.parent,\n      this.instrumentControls,\n      this.instrumentControlMap,\n      this.context,\n      this.x, this.y\n    )\n  }\n  trigger(message){\n    return this.parent.trigger(message)\n  }\n  setInstrument(instrument){\n    this.instrument = instrument\n    this.instrumentControls = []\n    this.instrumentControlMap = {}\n    this.build()\n    this.parent.drawScreen()\n  }\n  getPage(){\n    return this.trigger({ type: 'get_page', instrument: this.instrument })\n  }\n  renderChildren(){\n    this.children.forEach(child => child.render())\n    this.instrumentControls.forEach(child => child.render())\n  }\n  render(){\n    this.context.fillRect(this.x, this.y, 640, 480)\n    this.context.clearRect(this.x+1, this.y+1, 638, 478)\n    this.renderChildren()\n  }\n  handleClick(x, y, innerX, innerY){\n    let xCell = x - (this.x/40)\n    let yCell = y - (this.y/40)\n    let key = `${xCell}/${yCell}`\n    let module = this.moduleMap[key] || this.instrumentControlMap[key]\n    if(module) module.handleClick(x, y, innerX, innerY)\n  }\n}\n\n/*\n    0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16\n0   . . . . . . . . . . .  .  .  .  .  .  .\n1   . . . . . . . . . . .  .  .  .  .  .  .\n2   . . . . . . . . . . .  .  .  .  .  .  .\n3   . . . . . . . . . . .  .  .  .  .  .  .\n4   . . . . . . . . . . .  .  .  .  .  .  .\n5   . . . . . . . . . . .  .  .  .  .  .  .\n6   . . . . . . . . . . .  .  .  .  .  .  .\n7   . . . . . . . . . . .  .  .  .  .  .  .\n8   . . . . . . . . . . .  .  .  .  .  .  .\n9   . . . . . . . . . . .  .  .  .  .  .  .\n10  . . . . . . . . . . .  .  .  .  .  .  .\n11  . . . . . . . . . . .  .  .  .  .  .  .\n*/\n"],"sourceRoot":""}